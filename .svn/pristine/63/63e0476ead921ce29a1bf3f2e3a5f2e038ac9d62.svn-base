(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-48c739d6"],{"0aff":function(e,t,i){"use strict";i.r(t);var o=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("el-dialog",{attrs:{title:"图片裁剪",visible:e.dialog,"append-to-body":"",width:e.imgWidth+50+"px","close-on-click-modal":!1},on:{"update:visible":function(t){e.dialog=t}}},[i("div",{staticClass:"cropper-content"},[i("div",{staticClass:"cropper",staticStyle:{margin:"0 auto"},style:{height:e.imgHeight+10+"px",width:e.imgWidth+10+"px"}},[i("vueCropper",{ref:"cropper",attrs:{img:e.imgUrl,"output-size":e.option.size,"output-type":e.option.outputType,info:!0,full:e.option.full,"can-move":e.option.canMove,"can-move-box":e.option.canMoveBox,original:e.option.original,"auto-crop":e.option.autoCrop,fixed:e.option.fixed,"fixed-number":e.option.fixedNumber,"center-box":e.option.centerBox,"info-true":e.option.infoTrue,"fixed-box":e.option.fixedBox,"auto-crop-width":e.autoCropWidth,"auto-crop-height":e.autoCropHeight}})],1)]),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(t){return e.cropImage("cancel")}}},[e._v("取消")]),i("el-button",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{type:"primary"},on:{click:function(t){return e.cropImage()}}},[e._v("确认")])],1)])],1)},r=[],a=(i("9a33"),i("555e")),n={props:["imgUrl","autoCropWidth","autoCropHeight","imgWidth","imgHeight","imgFile"],data:function(){return{cropImg:"",imageUrl:"",dialog:!1,loading:!1,option:{img:"",info:!0,outputSize:1,outputType:"jpeg",canScale:!0,autoCrop:!0,fixedBox:!0,fixed:!1,full:!1,canMoveBox:!0,original:!1,centerBox:!1,infoTrue:!1}}},methods:{realTime:function(e){this.previews=e},getBase64:function(e,t){var i=new FileReader,o=21e5;e=e;e&&(i.readAsDataURL(e),i.onload=function(e){if(0!=o&&o<i.result.length)alert("上传失败，请上传不大于2M的图片！");else{var r=i.result;t(r)}})},cropImage:function(e){var t=this,i=this;e?i.dialog=!1:(this.$refs.cropper.getCropData((function(e){t.cropImg=e})),this.loading=!0,Object(a["w"])().then((function(e){var o=t.cropImg.split(",")[1]+"",r="https://upload.qiniup.com/putb64/-1",a=new XMLHttpRequest;a.onreadystatechange=function(){if(4==a.readyState){var t=JSON.parse(a.response);i.imageUrl=e.data.qiniuDomain+t.key,i.dialog=!1,i.loading=!1,i.$emit("imgUrl",i.imageUrl)}},a.open("POST",r,!0),a.setRequestHeader("Content-Type","application/octet-stream"),a.setRequestHeader("Authorization","UpToken ".concat(e.data.token)),a.send(o)})))}}},s=n,u=(i("4959"),i("9ca4")),c=Object(u["a"])(s,o,r,!1,null,"c2c4f6de",null);t["default"]=c.exports},"0c38":function(e,t,i){"use strict";i.d(t,"c",(function(){return r})),i.d(t,"a",(function(){return a})),i.d(t,"b",(function(){return n}));var o=i("b775");function r(e){return Object(o["a"])({url:"/ovu-zuul/ovu-mooc/api/v1/newknowledge/project/list",method:"get",params:e})}function a(e){return Object(o["a"])({url:"/ovu-zuul/ovu-mooc/api/v1/newknowledge/project/delete/".concat(e),method:"get"})}function n(e){return Object(o["a"])({url:"/ovu-zuul/ovu-mooc/api/v1/newknowledge/project/edit",method:"post",data:e})}},"18d9":function(e,t,i){"use strict";var o=i("277b"),r=i.n(o);r.a},"1def":function(e,t,i){"use strict";i.r(t);var o=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("el-dialog",{attrs:{title:"设置学员",width:"60%",visible:e.dialog,"append-to-body":"","close-on-click-modal":!1},on:{"update:visible":function(t){e.dialog=t},open:e.getList}},[i("div",{staticClass:"operate-panel_left",staticStyle:{"margin-bottom":"15px"}},[i("el-input",{staticClass:"filter-item",staticStyle:{"margin-left":"15px",width:"200px"},attrs:{placeholder:"学员姓名"},model:{value:e.listQuery.organizationName,callback:function(t){e.$set(e.listQuery,"organizationName",t)},expression:"listQuery.organizationName"}}),i("el-button",{directives:[{name:"waves",rawName:"v-waves"}],attrs:{type:"primary"},on:{click:e.getList}},[e._v("查询")]),i("el-button",{directives:[{name:"waves",rawName:"v-waves"}],attrs:{type:"default"},on:{click:e.resetQuery}},[e._v("重置")])],1),i("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],key:e.tableKey,ref:"stuTab",staticStyle:{width:"100%",height:"calc(100% - 128px)"},attrs:{data:e.list,border:"",fit:"","highlight-current-row":"","default-sort":{prop:"relationid",order:"descending"},"row-key":e.getRowKey},on:{"selection-change":e.changeFun,select:e.triggerSelect,"select-all":e.triggerAllSelect}},[i("el-table-column",{attrs:{type:"selection",width:"55","reserve-selection":!0,"row-key":e.getRowKeys}}),i("el-table-column",{attrs:{label:"NO",type:"index",width:"50",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",[e._v(" "+e._s((e.listQuery.currentPage-1)*e.listQuery.pageSize+t.$index+1)+" ")])]}}])}),i("el-table-column",{attrs:{label:"学员姓名",prop:"organizationName",align:"left","show-overflow-tooltip":""}}),i("el-table-column",{attrs:{label:"组织架构",prop:"depName",align:"left"}})],1),i("div",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total > 0"}],staticClass:"panel-page"},[i("pagination",{attrs:{total:e.total,page:e.listQuery.currentPage,limit:e.listQuery.pageSize},on:{"update:page":function(t){return e.$set(e.listQuery,"currentPage",t)},"update:limit":function(t){return e.$set(e.listQuery,"pageSize",t)},pagination:e.getList}})],1),i("div",{staticStyle:{"margin-top":"20px"}},[e._v(" 已选学员： "),i("ul",e._l(e.selectList,(function(t,o){return i("li",{key:o,staticClass:"item"},[i("span",{staticClass:"name"},[e._v(e._s(t.organizationName))]),i("span",{staticClass:"el-icon-circle-close del",on:{click:function(i){return e.deleteItem(e.selectList,t)}}})])})),0)]),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:e.cancel}},[e._v("取消")]),e.listLoading?e._e():i("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.updateData()}}},[e._v("确认")])],1)],1)],1)},r=[],a=(i("e204"),i("e697"),i("ed63"),i("8cf2"),i("6d57"),i("555e")),n=i("6724"),s=i("333d"),u={components:{Pagination:s["a"]},directives:{waves:n["a"]},props:["id","stuList"],data:function(){return{list:[],dialog:!1,tableKey:0,total:0,listLoading:!0,selectList:[],listQuery:{pageIndex:0,currentPage:1,pageSize:20}}},methods:{getList:function(){var e=this;this.listLoading=!0,this.listQuery.pageIndex=this.listQuery.currentPage-1,this.listQuery.relationtype=3,this.listQuery.courseid=this.id,Object(a["l"])(this.listQuery).then((function(t){if(e.list=t.data.data,e.total=t.data.totalCount,e.listLoading=!1,e.stuList.length){e.selectList=e.stuList;var i=e.stuList.reduce((function(e,t){return e.push(t.relationid),e}),[]);e.list.forEach((function(t){i&&-1!==i.indexOf(t.relationid)?e.$refs.stuTab.toggleRowSelection(t,!0):e.$refs.stuTab.toggleRowSelection(t,!1)}))}else e.$refs.stuTab.clearSelection(),e.$refs.stuTab.toggleAllSelection();var o=[],r=[];e.selectList.forEach((function(e){-1==o.indexOf(e.relationid)&&(o.push(e.relationid),r.push(e))})),e.selectList=r}))},triggerAllSelect:function(e){if(e.length)this.handleSelectionChange(e);else{var t=this.list.map((function(e){return e.id}));this.selectList=this.selectList.filter((function(e){return!t.includes(e.id)}))}},triggerSelect:function(e,t){e.find((function(e){return e.id===t.id}))||(this.selectList=this.selectList.filter((function(e){return e.id!==t.id})),this.setSelection())},setSelection:function(){var e=this;this.$nextTick((function(){var t=e.selectList.map((function(e){return e.id}));e.list.forEach((function(i){-1!==t.indexOf(i.id)?e.$refs.stuTab.toggleRowSelection(i,!0):e.$refs.stuTab.toggleRowSelection(i,!1)}))}))},changeFun:function(e){var t=this.selectList.map((function(e){return e.id})),i=e.filter((function(e){return!t.includes(e.id)}));this.selectList=this.selectList.concat(i)},deleteItem:function(e,t){var i=e.findIndex((function(e){return e.id==t.id}));e.splice(i,1),this.setSelection()},getRowKeys:function(e){return e.id},resetQuery:function(){this.listQuery={organizationName:"",pageIndex:0,currentPage:1,pageSize:1e3,courseid:this.courseid}},getRowKey:function(e){return e.id},updateData:function(){if(this.selectList.length||!this.list.length){var e=this.selectList&&this.selectList.length&&this.selectList.reduce((function(e,t){return e.push(t.relationid),e}),[]);this.$emit("changStu",e,this.selectList),this.dialog=!1}else this.$message.error("请选择学员")},cancel:function(){this.dialog=!1}}},c=u,l=(i("26b6"),i("9ca4")),d=Object(l["a"])(c,o,r,!1,null,"cafe1284",null);t["default"]=d.exports},"26b6":function(e,t,i){"use strict";var o=i("8f35"),r=i.n(o);r.a},"277b":function(e,t,i){},"333d":function(e,t,i){"use strict";var o=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"pagination-container",class:{hidden:e.hidden}},[i("el-pagination",e._b({attrs:{background:e.background,"current-page":e.currentPage,"page-size":e.pageSize,layout:e.layout,"page-sizes":e.pageSizes,total:e.total},on:{"update:currentPage":function(t){e.currentPage=t},"update:current-page":function(t){e.currentPage=t},"update:pageSize":function(t){e.pageSize=t},"update:page-size":function(t){e.pageSize=t},"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}},"el-pagination",e.$attrs,!1))],1)},r=[],a=(i("163d"),i("09f4")),n={name:"Pagination",props:{total:{required:!0,type:Number},page:{type:Number,default:1},limit:{type:Number,default:20},pageSizes:{type:Array,default:function(){return[10,20,30,50]}},layout:{type:String,default:"total, sizes, prev, pager, next, jumper"},background:{type:Boolean,default:!0},autoScroll:{type:Boolean,default:!0},hidden:{type:Boolean,default:!1}},computed:{currentPage:{get:function(){return this.page},set:function(e){this.$emit("update:page",e)}},pageSize:{get:function(){return this.limit},set:function(e){this.$emit("update:limit",e)}}},methods:{handleSizeChange:function(e){this.$emit("pagination",{page:this.currentPage,limit:e}),this.autoScroll&&Object(a["a"])(0,800)},handleCurrentChange:function(e){this.$emit("pagination",{page:e,limit:this.pageSize}),this.autoScroll&&Object(a["a"])(0,800)}}},s=n,u=(i("a648"),i("9ca4")),c=Object(u["a"])(s,o,r,!1,null,"d8e2954c",null);t["a"]=c.exports},"3d70":function(e,t,i){"use strict";i.d(t,"f",(function(){return r})),i.d(t,"e",(function(){return a})),i.d(t,"b",(function(){return n})),i.d(t,"h",(function(){return s})),i.d(t,"c",(function(){return u})),i.d(t,"d",(function(){return c})),i.d(t,"g",(function(){return l})),i.d(t,"a",(function(){return d}));var o=i("b775");function r(e){return Object(o["a"])({url:"/ovu-zuul/ovu-mooc/api/v1/newknowledge/paper/list",method:"get",params:e})}function a(e){return Object(o["a"])({url:"/ovu-zuul/ovu-mooc/api/v1/newknowledge/paperClassification/list",method:"get",params:e})}function n(e){return Object(o["a"])({url:"/ovu-zuul/ovu-mooc/api/v1/newknowledge/paperClassification/delete?id=".concat(e),method:"get"})}function s(e){return Object(o["a"])({url:"/ovu-zuul/ovu-mooc/api/v1/newknowledge/paperClassification/edit",method:"post",data:e})}function u(e){return Object(o["a"])({url:"/ovu-zuul/ovu-mooc/api/v1/newknowledge/paper/delete?ids=".concat(e),method:"get"})}function c(e){return Object(o["a"])({url:"/ovu-zuul/ovu-mooc/api/v1/newknowledge/paper/edit",method:"post",data:e})}function l(e){return Object(o["a"])({url:"/ovu-zuul/ovu-mooc/api/v1/newknowledge/paper/detail?paperId=".concat(e),method:"get"})}function d(e){return Object(o["a"])({url:"/ovu-zuul/ovu-mooc/api/v1/newknowledge/paper/publish",method:"post",data:e})}},4959:function(e,t,i){"use strict";var o=i("f50c"),r=i.n(o);r.a},"555e":function(e,t,i){"use strict";i.d(t,"o",(function(){return r})),i.d(t,"p",(function(){return a})),i.d(t,"n",(function(){return n})),i.d(t,"m",(function(){return s})),i.d(t,"l",(function(){return u})),i.d(t,"q",(function(){return c})),i.d(t,"r",(function(){return l})),i.d(t,"h",(function(){return d})),i.d(t,"i",(function(){return p})),i.d(t,"j",(function(){return f})),i.d(t,"c",(function(){return m})),i.d(t,"d",(function(){return g})),i.d(t,"b",(function(){return h})),i.d(t,"a",(function(){return v})),i.d(t,"e",(function(){return b})),i.d(t,"u",(function(){return y})),i.d(t,"t",(function(){return x})),i.d(t,"v",(function(){return w})),i.d(t,"x",(function(){return j})),i.d(t,"s",(function(){return k})),i.d(t,"k",(function(){return O})),i.d(t,"g",(function(){return S})),i.d(t,"f",(function(){return L})),i.d(t,"y",(function(){return $})),i.d(t,"w",(function(){return z}));i("e10e"),i("6d57");var o=i("b775");function r(e){return Object(o["a"])({url:"/ovu-zuul/ovu-mooc/api/v1/mooccourse/page",method:"get",params:e})}function a(e){return Object(o["a"])({url:"/ovu-zuul/ovu-mooc/api/v1/mooccoursematerial/page",method:"get",params:e})}function n(e){return Object(o["a"])({url:"/ovu-zuul/ovu-mooc/api/v1/moocteacher/page",method:"get",params:e})}function s(e){var t=new FormData;return Object.keys(e).forEach((function(i){t.append(i,e[i])})),Object(o["a"])({url:"/ovu-zuul/ovu-mooc/api/v1/moocclass/page",method:"post",data:t})}function u(e){var t=new FormData;return Object.keys(e).forEach((function(i){t.append(i,e[i])})),Object(o["a"])({url:"/ovu-zuul/ovu-mooc/api/v1/mooccoursetrainee/page",method:"post",data:t})}function c(e){return Object(o["a"])({url:"/ovu-zuul/ovu-mooc/api/v1/park/companyPage",method:"get",params:e})}function l(e){return Object(o["a"])({url:"/ovu-zuul/ovu-mooc/api/v1/park/staffPage",method:"get",params:e})}function d(e){return Object(o["a"])({url:"/ovu-zuul/ovu-mooc/api/v1/mooccourse/save",method:"post",data:e})}function p(e){return Object(o["a"])({url:"/ovu-zuul/ovu-mooc/api/v1/mooccoursematerial/save",method:"post",data:e})}function f(e){return Object(o["a"])({url:"/ovu-zuul/ovu-mooc/api/v1/mooccoursetrainee/save",method:"post",data:e})}function m(e){return Object(o["a"])({url:"/ovu-zuul/ovu-mooc/api/v1/mooccourse/delete/".concat(e),method:"get"})}function g(e){return Object(o["a"])({url:"/ovu-zuul/ovu-mooc/api/v1/mooccoursematerial/delete/".concat(e),method:"get"})}function h(e){return Object(o["a"])({url:"/ovu-zuul/ovu-mooc/api/v1/moocclass/delete/".concat(e),method:"get"})}function v(e){return Object(o["a"])({url:"/ovu-zuul/ovu-mooc/api/v1/mooccoursechapter/delete/".concat(e),method:"get"})}function b(e){return Object(o["a"])({url:"/ovu-zuul/ovu-mooc/api/v1/mooccoursetrainee/delete/".concat(e),method:"get"})}function y(e){return Object(o["a"])({url:"/ovu-zuul/ovu-mooc/api/v1/moocclass/listByTree",method:"get",params:e})}function x(e){return Object(o["a"])({url:"/ovu-zuul/ovu-mooc/api/v1/moocteacher/teacherList",method:"get",params:e})}function w(e){return Object(o["a"])({url:"/ovu-zuul/ovu-mooc/api/v1/park/deptTree",method:"get"})}function j(e){return Object(o["a"])({url:"/ovu-zuul/ovu-mooc/api/v1/park/peronalOrgTree",method:"get",params:e})}function k(e){return Object(o["a"])({url:"/ovu-zuul/ovu-mooc/api/v1/mooccoursechapter/listByTree",method:"get",params:e})}function O(e){return Object(o["a"])({url:"/ovu-zuul/ovu-mooc/api/v1/mooccourse/relTeacher",method:"post",data:e})}function S(e){return Object(o["a"])({url:"/ovu-zuul/ovu-mooc/api/v1/moocclass/save",method:"post",data:e})}function L(e){return Object(o["a"])({url:"/ovu-zuul/ovu-mooc/api/v1/mooccoursechapter/save",method:"post",data:e})}function $(e){return Object(o["a"])({url:"/ovu-zuul/ovu-mooc/api/v1/mooccoursetrainee/addStudent",method:"get",params:e})}function z(e){return Object(o["a"])({url:"/ovu-base/getQiNiuToken",method:"get",query:e})}},"60b8":function(e,t,i){"use strict";var o=i("4f54"),r=(i("e10e"),i("6d57"),i("31a6").Base64);t["a"]={data:function(){return{otherHeight:210}},computed:{maxHeight:function(){return this.$store.getters["settings/getClientHeight"]-this.otherHeight}},created:function(){this.assignQuery()},methods:{assignQuery:function(){var e=this.$route.query,t={};Object.keys(e).forEach((function(i){if(e.hasOwnProperty(i)&&e[i])try{var o=JSON.parse(r.decode(e[i]));if(!o.value)return;"string"===o.type?t[i]=o.value:"number"===o.type&&(t[i]=parseFloat(o.value))}catch(a){}})),Object.assign(this.listQuery,t)},handleFilter:function(){var e=this;this.listQuery.currentPage=1;var t=this.$route,i=t.path,a=t.query,n={};Object.keys(this.listQuery).forEach((function(t){n[t]=r.encode(JSON.stringify({type:Object(o["a"])(e.listQuery[t]),value:e.listQuery[t]})),"string"===typeof e.listQuery[t]&&(e.listQuery[t]=e.listQuery[t].trim())})),this.$router.push({path:i,query:Object.assign({},a,n)}),this.getList()}}}},6724:function(e,t,i){"use strict";i("8d41");var o="@@wavesContext";function r(e,t){function i(i){var o=Object.assign({},t.value),r=Object.assign({ele:e,type:"hit",color:"rgba(0, 0, 0, 0.15)"},o),a=r.ele;if(a){a.style.position="relative",a.style.overflow="hidden";var n=a.getBoundingClientRect(),s=a.querySelector(".waves-ripple");switch(s?s.className="waves-ripple":(s=document.createElement("span"),s.className="waves-ripple",s.style.height=s.style.width=Math.max(n.width,n.height)+"px",a.appendChild(s)),r.type){case"center":s.style.top=n.height/2-s.offsetHeight/2+"px",s.style.left=n.width/2-s.offsetWidth/2+"px";break;default:s.style.top=(i.pageY-n.top-s.offsetHeight/2-document.documentElement.scrollTop||document.body.scrollTop)+"px",s.style.left=(i.pageX-n.left-s.offsetWidth/2-document.documentElement.scrollLeft||document.body.scrollLeft)+"px"}return s.style.backgroundColor=r.color,s.className="waves-ripple z-active",!1}}return e[o]?e[o].removeHandle=i:e[o]={removeHandle:i},i}var a={bind:function(e,t){e.addEventListener("click",r(e,t),!1)},update:function(e,t){e.removeEventListener("click",e[o].removeHandle,!1),e.addEventListener("click",r(e,t),!1)},unbind:function(e){e.removeEventListener("click",e[o].removeHandle,!1),e[o]=null,delete e[o]}},n=function(e){e.directive("waves",a)};window.Vue&&(window.waves=a,Vue.use(n)),a.install=n;t["a"]=a},"6d93":function(e,t,i){"use strict";i.r(t);var o=i("6e6d");t["default"]=new o["default"]},7528:function(e,t,i){"use strict";i.d(t,"d",(function(){return r})),i.d(t,"c",(function(){return a})),i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return s})),i.d(t,"e",(function(){return u})),i.d(t,"g",(function(){return c})),i.d(t,"f",(function(){return l}));var o=i("b775");function r(e){return Object(o["a"])({url:"/ovu-zuul/ovu-mooc/api/v1/newknowledge/examine/list",method:"get",params:e})}function a(e){return Object(o["a"])({url:"/ovu-zuul/ovu-mooc/api/v1/newknowledge/examine/edit",method:"post",data:e})}function n(e){return Object(o["a"])({url:"/ovu-zuul/ovu-mooc/api/v1/newknowledge/examine/publish",method:"get",params:e})}function s(e){return Object(o["a"])({url:"/ovu-zuul/ovu-mooc/api/v1/newknowledge/examine/delete?ids=".concat(e),method:"get"})}function u(e){return Object(o["a"])({url:"/ovu-zuul/ovu-mooc/api/v1/newknowledge/result/list",method:"get",params:e})}function c(e){return Object(o["a"])({url:"/ovu-zuul/ovu-mooc/api/v1/newknowledge/result/info?resultId=".concat(e),method:"get"})}function l(e){return Object(o["a"])({url:"/ovu-zuul/ovu-mooc/api/v1/newknowledge/result/analyse?examineId=".concat(e),method:"get"})}},7902:function(e,t,i){"use strict";i.r(t);var o=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"app-container"},[i("el-page-header",{attrs:{content:e.form.id?"编辑测评":"新增测评",title:"返回"},on:{back:function(t){return e.$router.go(-1)}}}),i("el-form",{ref:"form",staticStyle:{"margin-top":"15px"},attrs:{model:e.form,"label-width":"120px",rules:e.rules}},[i("el-card",{staticClass:"box-card"},[i("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[i("span",{staticClass:"el-card-header-title"},[e._v("基本设置")])]),i("div",[i("div",{staticClass:"inline_block"},[i("div",[i("el-form-item",{staticClass:"inline_block",attrs:{label:"测评项目",prop:"projectObj"}},[i("el-select",{staticStyle:{"margin-right":"5px"},attrs:{placeholder:"请选择-测评项目",filterable:"","value-key":"id"},on:{change:function(t){return e.chooseProject(e.form.projectObj)}},model:{value:e.form.projectObj,callback:function(t){e.$set(e.form,"projectObj",t)},expression:"form.projectObj"}},e._l(e.projectList,(function(e){return i("el-option",{key:e.id,attrs:{value:e,label:e.name}})})),1)],1),i("el-form-item",{staticClass:"inline_block",attrs:{label:"测评名称",prop:"text"}},[i("el-input",{attrs:{type:"text",placeholder:"最多可输入32个字符"},model:{value:e.form.text,callback:function(t){e.$set(e.form,"text",t)},expression:"form.text"}})],1)],1),i("div",[i("el-form-item",{staticClass:"inline_block",attrs:{label:"关联课程"}},[i("el-select",{attrs:{filterable:"",placeholder:"选择课程","value-key":"id",clearable:""},on:{change:function(t){return e.checkCourse(e.form.courseObj)},clear:e.clearObj},model:{value:e.form.courseObj,callback:function(t){e.$set(e.form,"courseObj",t)},expression:"form.courseObj"}},e._l(e.list,(function(e){return i("el-option",{key:e.id,attrs:{value:e,label:e.coursename}})})),1)],1),i("el-form-item",{staticClass:"inline_block",attrs:{label:"有效期",prop:"date"}},[i("el-date-picker",{attrs:{type:"datetimerange",align:"right","unlink-panels":"","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期","picker-options":e.pickerOptions},on:{blur:function(t){return e.$forceUpdate()}},model:{value:e.form.date,callback:function(t){e.$set(e.form,"date",t)},expression:"form.date"}})],1),i("el-form-item",{attrs:{label:"测评类型",prop:"type"}},[i("el-radio",{attrs:{label:1,disabled:1==e.type||2==e.type},on:{change:e.changeType},model:{value:e.form.type,callback:function(t){e.$set(e.form,"type",t)},expression:"form.type"}},[e._v("公开")]),i("el-radio",{attrs:{label:2},on:{change:e.changeType},model:{value:e.form.type,callback:function(t){e.$set(e.form,"type",t)},expression:"form.type"}},[e._v("私有")]),i("el-radio",{attrs:{label:3,disabled:1==e.type},on:{change:e.changeType},model:{value:e.form.type,callback:function(t){e.$set(e.form,"type",t)},expression:"form.type"}},[e._v("邀请")])],1)],1),e.form.courseid&&2==e.form.type&&3!=e.type?i("el-form-item",[i("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.addStudent()}}},[e._v("添加学员")])],1):e._e()],1),i("div",{staticClass:"inline_block",staticStyle:{"vertical-align":"top"}},[i("el-form-item",{staticClass:"inline_block",attrs:{label:"封面",prop:"coverimage"}},[i("el-upload",{staticClass:"avatar-uploader",attrs:{action:e.baseUrl,"show-file-list":!1,"auto-upload":!1,"on-change":e.uploadFileMethodAnswer,"on-success":e.handleAvatarSuccess}},[e.form.coverimage?i("img",{staticClass:"avatar",attrs:{src:e.processImgUrl(e.form.coverimage)}}):i("i",{staticClass:"el-icon-plus avatar-uploader-icon"}),e.form.coverimage?i("i",{staticClass:"el-icon-close",staticStyle:{position:"absolute","z-index":"8",right:"10px","font-size":"16px"},on:{click:function(t){return e.removeImg(t)}}}):e._e(),i("div",{staticClass:"el-upload__tip",staticStyle:{color:"red","margin-top":"0"},attrs:{slot:"tip"},slot:"tip"},[e._v(" 建议尺寸:210px*120px ")])])],1)],1)])]),i("el-card",{staticClass:"box-card",staticStyle:{margin:"15px 0"}},[i("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[i("span",{staticClass:"el-card-header-title"},[e._v("选择试卷")])]),i("div",[i("el-form-item",{attrs:{label:"选择试卷",prop:"paperId"}},[i("el-select",{attrs:{placeholder:"选择试卷"},on:{change:function(t){return e.$forceUpdate()}},model:{value:e.form.paperId,callback:function(t){e.$set(e.form,"paperId",t)},expression:"form.paperId"}},e._l(e.paperList,(function(e){return i("el-option",{key:e.id,attrs:{value:e.id,label:e.text}})})),1)],1),i("el-form-item",{attrs:{label:"考试次数",prop:"count"}},[i("el-input-number",{staticStyle:{width:"178px"},attrs:{min:0,controls:!1},model:{value:e.form.count,callback:function(t){e.$set(e.form,"count",e._n(t))},expression:"form.count"}}),i("span",{staticClass:"test_tip"},[e._v("0次表示无限制")])],1),i("el-form-item",{attrs:{label:"考试时长",prop:"time"}},[i("el-input-number",{staticStyle:{width:"178px"},attrs:{min:0,controls:!1},model:{value:e.form.time,callback:function(t){e.$set(e.form,"time",e._n(t))},expression:"form.time"}}),i("span",{staticClass:"test_tip"},[e._v("0分钟表示无限制")])],1),i("el-form-item",{attrs:{label:"通过条件",prop:"passcondition"}},[i("el-select",{attrs:{placeholder:"请选择-通过条件"},model:{value:e.form.passcondition,callback:function(t){e.$set(e.form,"passcondition",t)},expression:"form.passcondition"}},e._l(e.conditions,(function(e){return i("el-option",{key:e.label,attrs:{label:e.label,value:e.value}})})),1)],1),i("el-form-item",{attrs:{label:"是否显示答案",prop:"isPublic"}},[i("el-radio",{attrs:{label:1},model:{value:e.form.isPublic,callback:function(t){e.$set(e.form,"isPublic",t)},expression:"form.isPublic"}},[e._v("显示")]),i("el-radio",{attrs:{label:0},model:{value:e.form.isPublic,callback:function(t){e.$set(e.form,"isPublic",t)},expression:"form.isPublic"}},[e._v("不显示")])],1)],1)]),i("el-card",{staticClass:"box-card",staticStyle:{margin:"15px 0"}},[i("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[i("span",{staticClass:"el-card-header-title"},[e._v("测评报告")])]),i("div",[e._l(e.testreport,(function(t,o){return i("div",{key:o},[i("label",{staticClass:"el-form-item__label",staticStyle:{"margin-left":"87px"}},[e._v("规则"+e._s(o+1))]),i("label",{staticClass:"el-form-item__label",staticStyle:{"margin-left":"87px"}},[e._v("得分")]),i("el-select",{attrs:{placeholder:"请选择"},model:{value:t.rule,callback:function(i){e.$set(t,"rule",i)},expression:"item.rule"}},e._l(e.symbol,(function(e){return i("el-option",{key:e,attrs:{label:e,value:e}})})),1),i("el-input",{staticStyle:{width:"178px",margin:"0 10px"},attrs:{type:"number",min:"0",placeholder:"请输入分值"},model:{value:t.score,callback:function(i){e.$set(t,"score",e._n(i))},expression:"item.score"}}),i("label",{staticClass:"el-form-item__label",staticStyle:{clear:"both",float:"none","margin-left":"15px"}},[e._v("评论内容")]),i("el-input",{staticStyle:{width:"calc(100% - 859px)",margin:"0 10px"},attrs:{placeholder:"请输入内容"},model:{value:t.content,callback:function(i){e.$set(t,"content",i)},expression:"item.content"}}),i("el-button",{on:{click:function(i){return e.delIrule(t)}}},[e._v("-")]),i("el-divider")],1)})),i("el-button",{staticClass:"addButtom",attrs:{type:"default",size:"medium"},on:{click:e.addRule}},[e._v("+新增规则")])],2)]),i("el-card",{staticClass:"box-card",staticStyle:{margin:"15px 0"}},[i("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[i("span",{staticClass:"el-card-header-title"},[e._v("其他设置")])]),i("div",[i("el-form-item",{attrs:{label:"测评须知",prop:"beforenotice"}},[i("el-input",{attrs:{placeholder:"最多可输入200个字符"},model:{value:e.form.beforenotice,callback:function(t){e.$set(e.form,"beforenotice",t)},expression:"form.beforenotice"}})],1),i("el-form-item",{attrs:{label:"测后说明",prop:"afterexplain"}},[i("el-input",{attrs:{placeholder:"最多可输入200个字符"},model:{value:e.form.afterexplain,callback:function(t){e.$set(e.form,"afterexplain",t)},expression:"form.afterexplain"}})],1)],1)])],1),i("div",{staticClass:"dialog-footer text-center",staticStyle:{margin:"15px 0"}},[i("el-button",{on:{click:e.cancel}},[e._v("取消")]),i("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.updateData()}}},[e._v("确定")])],1)],1),i("Crop",{ref:"dialogCropVisible",attrs:{"img-url":e.optionImg,"auto-crop-height":120,"auto-crop-width":210,"img-height":e.imgHeight,"img-width":e.imgWidth,"img-file":e.imgFile},on:{imgUrl:e.getUrl}}),e.form.courseid?i("Student",{ref:"dialogStudentVisible",attrs:{id:e.form.courseid,"stu-list":e.stuList},on:{changStu:e.changStu}}):e._e()],1)},r=[],a=(i("9a33"),i("cc57"),i("6d57"),i("6724")),n=(i("333d"),i("60b8"),i("555e")),s=i("3d70"),u=i("7528"),c=i("0aff"),l=i("1def"),d=i("6d93"),p=i("0c38"),f=i("31a6").Base64,m={directives:{waves:a["a"]},components:{Crop:c["default"],Student:l["default"]},data:function(){return{conditions:[{value:1,label:"提交试卷"},{value:2,label:"分数达标"}],project:{},projectList:[],selectStuList:[],testreport:[],list:[],total:0,loading:!1,form:{text:"",project:"",projectid:"",course:"",courseObj:{},startTime:"",endTime:"",type:1,ids:"",count:"",time:0,passcondition:2,isPublic:0,testreport:"",beforenotice:"",afterexplain:"",isRestrict:"",coverimage:"",date:"",projectObj:{},paperId:""},symbol:[">","<","="],type:3,queryPaper:{pageIndex:0,currentPage:1,pageSize:1e4,ispublish:1},queryPro:{pageIndex:0,currentPage:1,pageSize:1e4,type:1},query:{pageIndex:0,currentPage:1,pageSize:1e4,status:1},paperList:[],baseUrl:"/ovu-base/uploadImg",imgWidth:0,imgHeight:0,optionImg:"",imgFile:{},stuList:[],rules:{text:[{required:!0,message:"测评名称",trigger:"blur"},{max:32,message:"最多可输入32个字符",trigger:"blur"}],coverimage:[{required:!0,message:"请上传封面",trigger:"change"}],date:[{required:!0,message:"请选择有效期",trigger:"change"}],type:[{required:!0,message:"请选择测评类型",trigger:"change"}],ids:[{required:!0,message:"请选择试卷",trigger:"change"}],time:[{required:!0,message:"请输入考试时长",trigger:"blur"}],count:[{required:!0,message:"请输入考试次数",trigger:"blur"}],passcondition:[{required:!0,message:"请选择通过条件",trigger:"blur"}],isPublic:[{required:!0,message:"请选择是否显示答案",trigger:"change,blur"}],beforenotice:[{max:200,message:"最多可输入200个字符",trigger:"blur"}],afterexplain:[{max:200,message:"最多可输入200个字符",trigger:"blur"}],projectObj:[{required:!0,message:"请选择项目",trigger:"change,blur"}],paperId:[{required:!0,message:"请选择试卷",trigger:"change"}]},listLoading:!1,pickerOptions:{},value2:"",value3:"",listQuery:{pageIndex:0,currentPage:1,pageSize:10,id:""}}},mounted:function(){this.$route.query.info&&(this.project=JSON.parse(f.decode(this.$route.query.info))),localStorage.getItem("id")?(this.listQuery.id=localStorage.getItem("id"),this.getData()):(this.getList(),this.getPro())},activated:function(){this.$route.query.info&&(this.project=JSON.parse(f.decode(this.$route.query.info))),localStorage.getItem("id")?(this.listQuery.id=localStorage.getItem("id"),this.getData()):(this.getList(),this.getPro())},methods:{getList:function(){var e=this;this.query.pageIndex=this.query.currentPage-1,Object(n["o"])(this.query).then((function(t){e.list=t.data.data,e.form.courseid&&e.list.length&&e.list.forEach((function(t){t.id==e.form.courseid&&(e.form.courseObj=t,e.type=t.type,3==e.type&&(e.selectStuList=[],e.stuList=[],e.$forceUpdate(),e.form.personIds=void 0))}))})),Object(s["f"])(this.queryPaper).then((function(t){e.paperList=t.data.data}))},getPro:function(){var e=this;Object(p["c"])(this.queryPro).then((function(t){e.projectList=t.data.data||[];var i={id:-1,name:"默认项目"};e.projectList.unshift(i),e.projectList.length&&e.projectList.forEach((function(t){(e.project&&e.project.id&&t.id==e.project.id||e.form.projectid&&t.id==e.form.projectid)&&(e.form.projectObj=t,e.form.project=t.name,e.form.projectid=t.id)})),e.$forceUpdate()}))},checkCourse:function(e){this.form.courseid=e.id,this.form.course=e.coursename,this.type=e.type,3==this.type?this.form.type=1:this.form.type=2,this.form.personIds=void 0,this.selectStuList=[],this.stuList=[],this.$forceUpdate()},changeType:function(){this.selectStuList=[],this.stuList=[],this.$forceUpdate()},clearObj:function(){this.form.courseid=void 0,this.form.courseObj={},this.form.course="",this.form.type=1,this.form.personIds=void 0,this.selectStuList=[],this.stuList=[],this.$forceUpdate()},addStudent:function(){var e=this;this.$nextTick((function(){var t=e.$refs.dialogStudentVisible;t.dialog=!0}))},changStu:function(e,t){this.selectStuList=e,this.stuList=t,this.$forceUpdate()},chooseProject:function(e){this.form.project=e.name,this.form.projectid=e.id,this.$forceUpdate()},handleAvatarSuccess:function(e,t){this.form.coverimage=e.urls},uploadFileMethodAnswer:function(e){var t=this,i="image/jpeg"===e.raw.type||"image/png"===e.raw.type;if(!i)return this.$message.error("上传头像图片只能是 JPG/PNG 格式!"),!1;this.imgFile=e;var o=new Image;o.src=URL.createObjectURL(e.raw);var r=this;o.onload=function(e){this.width-0>472?this.width<=1e3?(r.imgWidth=this.width,r.imgHeight=this.height):(r.imgWidth=1e3,r.imgHeight=1e3/this.width*this.height):(r.imgWidth=472,r.imgHeight=this.height),this.height-0<258&&(r.imgHeight=258)},this.$nextTick((function(){t.optionImg=URL.createObjectURL(e.raw);var i=t.$refs.dialogCropVisible;i.dialog=!0}))},getUrl:function(e){this.form.coverimage=e,this.$set(this.form,"coverimage",e),this.$forceUpdate()},removeImg:function(e){e.stopPropagation(),this.form.coverimage="",this.$forceUpdate()},addRule:function(){5!=this.testreport.length?this.testreport.push({}):this.$message.error("规则不能超过5个！")},delIrule:function(e){this.testreport.splice(this.testreport.indexOf(e),1),this.$forceUpdate()},cancel:function(){this.form.id?this.getData():this.$router.push("/test/project")},updateData:function(){var e=this;this.form.courseid&&2==this.form.type&&3!=this.type&&0==this.selectStuList.length?this.$message.error("请设置学员"):(2!=this.form.type?(this.selectStuList=[],this.form.personIds=void 0):this.form.courseid||(this.form.personIds=void 0),this.$refs["form"].validate((function(t){if(!t)return!1;0==e.form.count?e.form.isRestrict=0:e.form.isRestrict=1,e.form.startTime=e.moment(new Date(e.form.date[0])).format("YYYY-MM-DD HH:mm:ss"),e.form.endTime=e.moment(new Date(e.form.date[1])).format("YYYY-MM-DD HH:mm:ss"),e.form.ispublish=0,e.selectStuList.length&&(e.form.personIds=e.selectStuList.join(",")),e.form.testreport=JSON.stringify(e.testreport),e.loading=!0,e.form.id||(e.form.ids=e.form.paperId),Object(u["c"])(e.form).then((function(t){0==t.code?(e.$message.success("提交成功"),e.form.id||(e.$refs["form"].clearValidate(),e.$refs["form"].resetFields(),e.$router.push("/test/testList"),d["default"].$emit("getlist"))):(e.$message.error(t.msg),e.$router.push("/test/testList")),e.loading=!1}))})))},getData:function(){var e=this;this.listQuery.pageIndex=this.listQuery.currentPage-1,Object(u["d"])(this.listQuery).then((function(t){e.form=t.data.data[0],e.total=t.data.totalCount,e.form.courseid&&2==e.form.type?(e.stuList=e.form.personList||[],e.form.personIds&&(e.selectStuList=e.form.personIds.split(","))):e.stuList=[],e.stuList.length&&e.stuList.forEach((function(e){e.relationid=e.id})),e.form.date=[new Date(e.form.startTime),new Date(e.form.endTime)],e.form.testreport&&(e.testreport=JSON.parse(e.form.testreport)),e.getList(),e.getPro()})),this.$forceUpdate()}}},g=m,h=(i("18d9"),i("9ca4")),v=Object(h["a"])(g,o,r,!1,null,"d6a6b86e",null);t["default"]=v.exports},"8d41":function(e,t,i){},"8f35":function(e,t,i){},a648:function(e,t,i){"use strict";var o=i("b955"),r=i.n(o);r.a},b955:function(e,t,i){},f50c:function(e,t,i){}}]);